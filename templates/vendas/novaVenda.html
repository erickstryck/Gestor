	  <!DOCTYPE html>
	  <html class="no-js" lang="pt">
	  <head>
	  	<meta charset="utf-8" />
	  	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	  	<title>Novo Contato</title>
	  	<link rel="stylesheet" href="templates/lib/css/foundation.css" />
	  	<link rel="stylesheet" href="templates/lib/css/font-awesome/css/font-awesome.min.css" />
	  	<script src="templates/lib/js/vendor/modernizr.js"></script>

	  	<style type="text/css">
	  		.separator{
	  			margin-top: 0; 
	  			margin-bottom: 0; 
	  		}

	  		input.fix{
	  			height:35px !important;
	  			margin:0 !important;
	  			padding:0;
	  		}
	  		

	  		select.fix{
	  			margin:0;
	  			padding:0;
	  		}

	  		td.fix{	
	  			padding: 2px 2px 2px 2px !important; 	

	  		}

	  		.grande{
	  			margin:0;
	  			font-size:12px;
	  			font-weight:bold;
	  		}

	  		.pequeno{
	  			font-size:11px; 
	  			font-weight:normal;
	  		}
	  	</style>

	  </head>
	  <body>
	  	<!--top bar bagin -->  
	  	<!-- $Include templates/lib/html/header.html --> 
	  	<!--top bar end--> 

	  	<!-- body section-->

	  	<!-- title -->
	  	<div class="row">
	  		<div class="medium-12 columns ">
	  			<h3>VENDAS</h3>
	  		</div>	
	  	</div>

	  	<!-- botões --> 
	  	<div class="row">
	  		<div class="medium-12 columns">
	  			<button class="button success small" data-reveal-id="nova_venda"> <i class="fa fa-plus fa-lg"></i> Nova Venda</button>
	  			<button class="button secondary small"><i class="fa fa-tags fa-lg" style="margin-right:4px"></i>Etiquetas</button>
	  		</div>
	  	</div>

	  	<!-- container main --> 
	  	<div class="row">
	  		<div class="medium-12 columns">

	  			<!-- tabela --> 
	  			<table >
	  				<thead>
	  					<tr>
	  						<th width="30;"></th>
	  						<th width="30">COD</th>
	  						<th width="600">VENDA</th>
	  						<th width="600">ENTREGA</th>
	  						<th width="150">VENDEDOR</th>
	  						<th width="600">REFERÊNCIA</th>
	  						<th width="30;">SITUAÇÃO</th>
	  						<th width="30">TOTAL PRODUTO</th>
	  						<th width="150">TOTAL VENDA</th>

	  					</tr>
	  				</thead>
	  				<tbody>

	  					<!-- $BeginBlock row --> 
	  					<tr>
	  						<td><input type="checkbox" name="none" value="${catogoria.id}"></td>
	  						<td style="font-size: 12px;">${catogoria.id}</td>
	  						<td style="font-size: 12px;">${categoria.nome_categoria}</td>
	  						<td style="font-size: 12px;">${categoria.margem_lucro}</td>
	  						<td style="font-size: 12px;">${categoria.nome_categoria}</td>
	  						<td style="font-size: 12px;">${categoria.margem_lucro}</td>
	  						<td style="font-size: 12px;">${categoria.nome_categoria}</td>
	  						<td style="font-size: 12px;">${categoria.margem_lucro}</td>
	  						<td style="font-size: 12px;">${categoria.nome_categoria}</td>
	  						<td style="font-size: 12px;">${categoria.margem_lucro}</td>
	  					</tr>
	  					<!-- $EndBlock row --> 

	  				</tbody>
	  			</table>
	  			<!-- fim tabela --> 
	  		</div>	
	  	</div>	
	  	<!-- end body section--> 


	  	<!-- modal sections --> 

	  	<!-- Modal para mostrar o orçamento -->
	  	<div id="orcamento" class="reveal-modal" data-reveal aria-labelledby="firstModalTitle" aria-hidden="true" role="dialog" data-reveal-ajax="true">
	  		

	  		<a class="close-reveal-modal" aria-label="Close">&#215;</a>
	  	</div>
	  	<!-- Fim do modal orçamento -->
	  	
	  	<!-- nova venda --> 
	  	<div id="nova_venda" class="reveal-modal xlarge" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
	  		<h2 id="modalTitle">Nova Venda</h2>
	  		<p class="lead">Insira os dados abaixo</p>
	  		<!-- formulário --> 
	  		<form id="form_venda" data-abide="ajax" >

	  			<div class="row">
	  				<!--coluna 1--> 
	  				<div class="medium-6 columns">
	  					<div class="row">
	  						<div class="medium-8 columns">
	  							<label>Nome do Cliente 
	  								<select required name="contato_id"> <small style="color:red; ">Obrigatório</small>
	  									<option value="">- Selecione -</option>
	  									<!-- $BeginBlock contato --> 
	  									<option value="${contato.id}">${contato.nome}</option>
	  									<!-- $EndBlock  contato -->
	  								</select> <small class="error">Selecione um item</small>
	  							</label>
	  						</div>

	  						<div class="medium-4 columns">
	  							<label>Vendedor 
	  								<select name="usuario_id" required > <small style="color:red; ">Obrigatório</small>
	  									<option value="" >- Selecione -</option>
	  									<!-- $BeginBlock vendedor --> 
	  									<option value="${vendedor.id}">${vendedor.nome}</option>
	  									<!-- $EndBlock  vendedor -->
	  								</select> <small class="error">Selecione um item</small>
	  							</label>
	  						</div>

	  					</div>

	  					<div class="row">
	  						<div class="medium-4 columns">
	  							<label>Data de venda <input type="date" name="data_venda" value="${data_venda}" /></label>
	  						</div>

	  						<div class="medium-4 columns">
	  							<label>Data entrega <input type="date" name="data_entrega" /></label>
	  						</div>

	  						<div class="medium-4 columns">
	  							<label>Referência <input type="text" name="referencia" /></label>
	  						</div>
	  					</div>

	  					<div class="row">
	  						<div class="medium-4 columns">
	  							<label>Valor frete <input type="number" value="0" id="valor_frete" name="valor_frete" /></label>
	  						</div>

	  						<div class="medium-4 columns">
	  							<label>Valor seguro <input type="number" value="0" id="valor_seguro" name="valor_seguro" /></label>
	  						</div>

	  						<div class="medium-4 columns">
	  							<label>Outras despesas <input type="number" value="0" id="outras_despesas" name="outras_despesas" /></label>
	  						</div>
	  					</div>

	  					<div class="row">
	  						<div class="medium-12 columns">
	  							<label>Observações gerais <textarea name="obs_gerais"></textarea></label>
	  						</div>
	  					</div>

	  					

	  					<div class="row">
	  						<div class="medium-12 columns">
	  							

	  						</div>
	  					</div>

	  				</div>	

	  				<!-- coluna 2--> 
	  				<div class="medium-6 columns">

	  					<div class="row">
	  						<div class="medium-12 columns">
	  							<h3>Adicionar produtos</h3>
	  						</div>
	  					</div>

	  					<hr class="separator" />

	  					<div class="row">
	  						<div class="medium-6 columns">
	  							<label>Adicionar produto. 
	  								<select id="produto" required > <small style="color:red; ">Obrigatório</small>
	  									<option value="">- Selecione -</option>
	  									<!-- $BeginBlock produto --> 
	  									<option value="${produto.id}">${produto.nome}</option>
	  									<!-- $EndBlock  produto -->
	  								</select> <small class="error">Selecione um item</small>
	  							</label>
	  						</div>

	  						<div class="medium-3 columns">
	  							<label>Quant.  <input type="number" value='1' id="quantidade" /></label>
	  						</div>

	  						<div class="medium-3 columns">
	  							<label>Preço unit.<input id="preco_unit" value="1"type="number" /></label>
	  						</div>
	  					</div>	

	  					<div class="row">
	  						<div class="medium-9 columns">
	  							<label>Observações adicionais<textarea id="pedido_info"></textarea></label>
	  						</div>

	  						<div class="medium-2 columns end">
	  							<a class="button info tiny" id="adicionar" style="margin-top:30px;margin-left:15px;"> Adicionar</a>
	  						</div>
	  					</div>

	  					<hr class="separator" />

	  					<div class="row">
	  						<div class="medium-12 columns">
	  							<!--tabela--> 
	  							<table id="table">
	  								<caption><small>Produtos adicionados neste pedido de venda.</small></caption>
	  								<thead>
	  									<tr>
	  										<th width="350">Produto</th>
	  										<th >Quantidade</th>
	  										<th width="350">Preço*Quantidade</th>
	  										<th width="50"></th>
	  									</tr>
	  								</thead>
	  							</table>
	  							<!--fim tabela--> 
	  							<small  style="font-size:12px;">Total: <b id="total">0</b> </small>
	  						</div>
	  					</div>

	  				</div>

	  				<hr class="saperator" /> 
	  				<div class="row">
	  					<div class="medium-4 columns">
	  						<input id="pg" type="checkbox"> <label for="pg">Definir forma de pagamento</label>
	  					</div>
	  				</div> 

	  				<!--começo segundo formulário--> 
	  				<div id="part_2" class="row hide ">
	  					<div class="medium-12 columns">
	  						<div class="row">
	  							<div class="medium-3 columns">
	  								<label> Forma de pegamento
	  									<select id="forma_pagamento" name="forma_pagamento_id">
	  										<option value="">- Selecione -</option>
	  										<option value="1">A vista</option>
	  										<option value="2">Parcelado</option>
	  									</select>
	  								</label>
	  							</div>

	  							<div class="medium-3 columns">
	  								<label>Parcelas 
	  									<select id="parcelas" name="parcelas">
	  										<option value="">- Selecione -</option>
	  										<option value="1">1</option>
	  										<option value="2">2</option>
	  										<option value="3">3</option>
	  										<option value="4">4</option>
	  										<option value="5">5</option>
	  										<option value="6">6</option>
	  										<option value="7">7</option>
	  										<option value="8">8</option>
	  										<option value="9">9</option>
	  										<option value="10">10</option>
	  										<option value="11">11</option>
	  										<option value="12">12</option>
	  									</select>
	  								</label>
	  							</div>

	  							<div class="medium-3 columns">
	  								<label>Tipo entrada 
	  									<select id="tipo_entrada" name="tipo_entrada_id" > 
	  										<option value="">- Selecione -</option>
	  										<option value="1">Sem entrada</option>
	  										<option value="2">Com entrada igual</option>
	  										<option value="3">Com entrada diferente</option>
	  									</select>
	  								</label>
	  							</div>

	  							<div class="medium-3 columns">
	  								<label>Valor entrada 
	  									<input id="valor_entrada" type="number" value="0" min="0" name="valor_entrada" /> 
	  								</label>
	  							</div>

	  						</div>	

	  						<div class="row">
	  							<div class="medium-3 columns">
	  								<label>Tipo de desconto 
	  									<select id="tipo_desconto" name="tipo_desconto_id">
	  										<option value="">- Selecione -</option>
	  										<option value="1">Sem Desconto</option>
	  										<option value="2">Desconto em porcentagem</option>
	  										<option value="3">Desconto em valor</option>
	  									</select>
	  								</label>
	  							</div>

	  							<div class="medium-3 columns end">
	  								<label>Valor desconto
	  									<input id="valor_desconto" value="0" min="0"  type="number" name="valor_desconto" /> 
	  								</label>
	  							</div>
	  						</div>

	  						<div class="row">
	  							<div class="medium-2 columns">
	  								<input id="checkbox1" type="checkbox" value="on" name="juros"><label for="checkbox1">Juros</label>
	  							</div>	
	  						</div>

	  						<div class="row"> 
	  							<div class="medium-2 columns">
	  								<input id="checkbox2" type="checkbox" value="on" name="taxa_fixa"><label for="checkbox2">Taxa Fixa</label>
	  							</div>
	  						</div>

	  						<!-- início label --> 
	  						<div class="row"> 
	  							<div class="medium-2 columns">
	  								<span class="label">Parcela Entrada</span>
	  							</div>
	  						</div>
	  						<!-- fim label --> 
	  						<hr class="separator" /> 

	  						<!-- table --> 

	  						<div class="row">
	  							<div class="medium-12 columns">

	  								<table>
	  									<caption><small>Parcelamento deste pedido de compra</small></caption>
	  									<thead>
	  										<tr>
	  											<th width="200">Valor Parcela($)</th>
	  											<th width="50">Data Vencimento</th>
	  											<th width="150">Destino</th>
	  											<th width="150">Documento</th>	
	  											<th width="200">Número do doc.</th>
	  											<th width="500">Palavra-chave</th>
	  											<th width="150">Custo Int.</th>
	  										</tr>
	  									</thead>

	  									<tbody id="parcelas_body">
	  										<!-- template row 
	  										<tr>
	  											<td class="fix" ><input  class="fix" type="number" /> </td>
	  											<td class="fix" ><input  class="fix" type="date" /></td>
	  											<td class="fix" ><select class="fix" ><option>-Selecione-</option></select></td>
	  											<td class="fix" ><select class="fix" ><option>-Selecione-</option></select></td>
	  											<td class="fix" ><input  class="fix" type="text" /></td>
	  											<td class="fix" ><input  class="fix" type="text" /></td>
	  											<td class="fix" ><input  class="fix"type="text" /></td>
	  										</tr>
	  										template row fim--> 
	  									</tbody>
	  								</table>

	  							</div>
	  						</div>	

	  					</div>	
	  					<!--fim segundo formulário --> 
	  					<!-- botões -->
	  					<div class="row">
	  						<div class="medium-12 columns">		
	  							<div class="panel clearfix" style="height:75px;">
	  								<button class="button success tiny right"  >Vender</button>	
	  								<button class="button info tiny left"  >Apenas Orçar</button>	
	  							</div>	
	  						</div>
	  					</div>	

	  				</div>
	  			</form>
	  			<!-- fim formulário --> 
	  			<a class="close-reveal-modal" aria-label="Close">&#215;</a>
	  		</div>


	  		<script src="templates/lib/js/vendor/jquery.js"></script>
	  		<script src="templates/lib/notify/lib/alertify.min.js"></script>
	  		<script src="templates/lib/js/foundation.min.js"></script>

	  		<script src="templates/lib/js/ajax.js"type="text/javascript"></script>
	  		<link rel="stylesheet" href="templates/lib/notify/themes/alertify.default.css" />
	  		<link rel="stylesheet" href="templates/lib/notify/themes/alertify.core.css" />
	  		<link rel="stylesheet" href="templates/lib/css/foundation.css" />

	  		<script>
	  			$(document).foundation();

	  			$(document).ready(function(){
	  				var total=0;
	  				var valorFrete = 0; 
	  				var valorSeguro = 0; 
	  				var outrasDespesas = 0;

	  				var pedido   = new Array(); 
	  				var parcelas = new Array(); 

	  			//Manipulando eventos do formulário 'forma de pagamento'
	  			$('#pg').change(function(){
	  				if(this.checked)
	  					$('#part_2').removeClass('hide'); 
	  				else
	  					$('#part_2').addClass('hide'); 
	  			}); 

	  			$('#forma_pagamento').change(function(){
	  				var value = $('#forma_pagamento option:selected').val(); 
	  				if(value == 1 ){
	  					$('#parcelas').attr("disabled", true); 
	  					$('#tipo_entrada').attr('disabled', true); 
	  					$('#valor_entrada').attr('disabled', true); 
	  					$('#tipo_desconto').attr('disbled',true); 
	  				}else{
	  					$('#parcelas').attr("disabled", false); 
	  					$('#tipo_entrada').attr('disabled', false); 
	  					$('#valor_entrada').attr('disabled', false); 
	  					$('#tipo_desconto').attr('disbled', false); 
	  				}
	  			}); 

	  			$('#parcelas,#tipo_entrada,#valor_entrada,#tipo_desconto,#valor_desconto,#adicionar').change(function(){
	  				var value = $('#parcelas option:selected').val(); 
	  				addRowParcelas(value); 
	  			}); 


	  			//Manipulador do dos valores do formulários à esquerda. 
	  			$('#valor_frete').change(function(){
	  				var temp = parseFloat($(this).val());
	  				if( typeof temp != "number" || isNaN(temp) )return; 
	  				totalChange(temp,valorFrete);
	  				valorFrete = temp;  
	  			}); 

	  			$('#valor_seguro').change(function(){
	  				var temp = parseFloat($(this).val()); 
	  				if( typeof temp != "number" || isNaN(temp) )return;
	  				totalChange(temp,valorSeguro);
	  				valorSeguro = temp; 
	  			}); 

	  			$('#outras_despesas').change(function(){
	  				var temp = parseFloat($(this).val()); 
	  				if( typeof temp != "number" || isNaN(temp) )return;
	  				totalChange(temp,outrasDespesas);
	  				outrasDespesas = temp; 
	  			}); 

	  			$('#form_venda').on('valid.fndtn.abide', function() {
	  				//Se a quantidade de itens no pedido for igual a 0: 
	  				if(pedido.length == 0 ){
	  					alertify.error("Para efetuar uma venda é necessário no mínimo um produto"); 
	  					return; 
	  				}

	  				var data     = $('#form_venda').serializeArray(); 
	  				var array    = generateInput(); 
	  				var parcelas = getPercelasArray(); 

	  				for( var a = 0 ; a < array.length ; a++)
	  					data.push(array[a]);
	  				for( var a = 0 ; a < parcelas.length ; a++)
	  					data.push(parcelas[a]); 



	  				sendAjax('index.php?uc=vendas&a=cadastro','POST',data,function(data){
	  					alertify.log(data); 

	  					data = JSON.parse(data); 
	  					if(data['status']){
	  						alertify.success('A sua venda foi efetuada com sucesso.');  
	  						$('#orcamento').foundation('reveal', 'open', 'index.php?uc=vendas&a=orcamentoView&id='+data['id']);
	  					}else{
	  						alertify.error(data['msg'], "", 0); 
	  					}
	  					
	  				}); 

	  			}); 

	  			$("#produto").change(function(){
	  				var value = $("#produto option:selected").val();
	  				data = { 'produto_id' : value}
	  				sendAjax('index.php?uc=ajaxServices&a=getProductPrince','POST',data,function(data){
	  					data = JSON.parse(data); 
	  					$('#preco_unit').val(data['prince']); 
	  				}); 
	  			}); 

	  			$("#adicionar").click(function(){
	  				var nome = $('#produto option:selected').text(); 
	  				var id   = $('#produto option:selected').val();
	  				var quantidade = $("#quantidade").val(); 
	  				var preco_unit = $("#preco_unit").val(); 
	  				var info       = $("#pedido_info").val(); 

	  				var preco = parseFloat((parseFloat(preco_unit) * parseFloat(quantidade)).toFixed(3)); 
	  				if(!addProduto(id,preco,quantidade,info))return ;

	  				$("#pedido_info").val('');

	  				total += preco; 
	  				$("#total").text(total); 

	  				var row = '<tr> <td>'+nome+'</td><td>'+quantidade+'</td><td>'+preco+'</td><td> <button value="'+id+'"class="fa fa-trash" style="padding:10px;margin-bottom:0;"></button></td></tr>'
	  				$('#table').append(row); 	


	  				//Adicionando manipulador de eventos a linha recém adicionanda; 
	  				$('button.fa-trash').click(function(){
	  					var idProduto  = $(this).val(); 
	  					for(var a = 0 ; a < pedido.length ; a++ ){
	  						console.log(pedido['a']); 
	  						if( idProduto == pedido[a].id ){
	  							total = parseFloat((total -pedido[a].preco).toFixed(3));
	  							$("#total").text(total); 
	  							pedido.splice(a,1);
	  							break;
	  						}
	  					}
	  					var tr = $(this).parent().parent(); 
	  					tr.remove(); 
	  					//Registrando novo total na lista de parcelas: 
	  					var value = $('#parcelas option:selected').val(); 
	  					addRowParcelas(value); 
	  				}); 
	  			}); 

	  function addProduto(id,precoCustom,quantidade,info){ 
	  				//AdicionandoPedido no array. 
	  				for( var a = 0 ; a < pedido.length ; a++){
	  					if(id == pedido[a].id){
	  						alertify.error('Esse produto já foi adicionado no pedido de venda.');
	  						return false; 
	  					}
	  				}
	  				pedido.push({'id' : id , 'preco' : precoCustom, 'quantidade' : quantidade, 'info' : info }); 
	  				return true; 
	  			}

	  			function generateInput(){
	  				var temp = new Array();
	  				for( var a = 0 ; a < pedido.length ; a++ ){
	  					temp.push({name : 'item['+a+']' , value : JSON.stringify(pedido[a])}); 
	  				}
	  				return temp; 	
	  			}

	  			function totalChange(newValue, lastValue){
	  				console.log(newValue); 
	  				total -= lastValue; 
	  				total += newValue; 
	  				$("#total").text(total); 
	  			}

	  			function addRowParcelas(qtdParcelas){
	  				var totalTemp = total; 
	  				var date = new Date(); 
					//chamando a função do cálculo do desconto: 
					totalTemp  = calcularValor(totalTemp); 
					qtdParcelas = parseInt(qtdParcelas); 

					$('#parcelas_body').find('tr').each(function(){
						$(this).remove(); 
					}); 

					var valor = $('#tipo_entrada option:selected').val(); 
					if(valor == 2 || valor == 3 ){
						var entrada = parseFloat($("#valor_entrada").val());
						if(qtdParcelas == 1 ){
							$('#valor_entrada').val(totalTemp); 
							entrada = totalTemp; 
						}
						if(valor == 3){ 
							if(entrada > totalTemp){ 
								alertify.error("O seu valor de <b>entrada é maior</b> que o montante total da venda");
								return;
							}
							totalTemp -= entrada; 
						}else{
							entrada    = parseFloat((totalTemp/(qtdParcelas+1)));
							totalTemp -= entrada; 
						}

						var row = '<tr style="background-color:rgb(0,140,186);" id="0"> <td class="fix" ><input class="fix entrada" type="number" value="'+entrada+'"/> </td><td class="fix" ><input class="fix data" type="date" value="'+dataAtualFormatada(date.getDate(), date.getMonth())+'"/></td><td class="fix" ><select class="fix destino" ><option value="">-Selecione-</option><option value="1">Caixa Interno</option></select></td><td class="fix" ><select class="fix documento" ><option value="">-Selecione-</option><option value="1">Dinheiro</option><option value="2">Cheque</option><option value="3">Boleto</option><option value="4">Cartão Crédito</option><option value="5">Cartão Débito</option><option value="6">Duplicata</option><option value="7">Carnê</option><option value="8">Trans. Eletrônica</option><option value="9">Sem Documento</option></select></td><td class="fix" ><input class="fix num_documento" type="text"/></td><td class="fix" ><input class="fix palavra_chave" type="text"/></td><td class="fix" ><input class="fix custo_int"type="text"/></td></tr>'; 
						$('#parcelas_body').append(row);
						//qtdParcelas--; 
					}

					for(var a = 0 ; a < qtdParcelas ; a++){
						var row = '<tr id="'+(a+1)+'"> <td class="fix" ><input class="fix entrada" type="number" value="'+(totalTemp/qtdParcelas)+'"/> </td><td class="fix" ><input class="fix data" type="date" value="'+dataAtualFormatada(date.getDate(), date.getMonth()+a+2)+'"/></td><td class="fix" ><select class="fix destino" ><option value="">-Selecione-</option><option value="1">Caixa Interno</option></select></td><td class="fix" ><select class="fix documento" ><option value="">-Selecione-</option><option value="1">Dinheiro</option><option value="2">Cheque</option><option value="3">Boleto</option><option value="4">Cartão Crédito</option><option value="5">Cartão Débito</option><option value="6">Duplicata</option><option value="7">Carnê</option><option value="8">Trans. Eletrônica</option><option value="9">Sem Documento</option></select></td><td class="fix" ><input class="fix num_documento" type="text"/></td><td class="fix" ><input class="fix palavra_chave" type="text"/></td><td class="fix" ><input class="fix custo_int" type="text"/></td></tr>'; 
						$('#parcelas_body').append(row);
					}

	  				//Adicionando manipulador de eventos as linhas recém adicionadas (select.documento). 
	  				$('.documento').change(function(){
	  					var comecar = false; 
	  					var objetoAtual = $(this).parent().parent();
	  					var selectAtual = $(this);  
	  					console.log(objetoAtual.attr('id')); 

	  					$('#parcelas_body').find('tr').each(function(){
	  						if(parseInt($(this).attr('id')) > parseInt(objetoAtual.attr('id')) ){
	  							$(this).find('select.documento').val(selectAtual.val()); 
	  						} 
	  					}); 
	  				}); 

	  				//Adicionando manipulador de eventos as linhas recém adicionados (select.destino)
	  				$('.destino').change(function(){
	  					var comecar = false; 
	  					var objetoAtual = $(this).parent().parent();
	  					var selectAtual = $(this);  
	  					console.log(objetoAtual.attr('id')); 

	  					$('#parcelas_body').find('tr').each(function(){
	  						if(parseInt($(this).attr('id')) > parseInt(objetoAtual.attr('id')) ){
	  							$(this).find('select.destino').val(selectAtual.val()); 
	  						} 
	  					}); 
	  				}); 
	  			}

	  			function calcularValor(valor){
	  				var tipo = $('#tipo_desconto option:selected').val(); 
	  				var montante = parseFloat($('#valor_desconto').val()); 
	  				//Tratar como percentagem;  
	  				if( tipo == 2 )
	  					return (valor - (( valor / 100 ) * montante ) ); 

	  				//tratar como valor; 
	  				if( tipo == 3 )
	  					return valor - montante; 

	  				return valor; 
	  			}

	  			//d = dia, m = mês. 
	  			function dataAtualFormatada(d,m){
	  				var data = new Date();
	  				data.setMonth(m,d)

	  				var dia = data.getDate();
	  				if (dia.toString().length == 1)
	  					dia = "0"+dia;
	  				var mes = data.getMonth()+1;
	  				if (mes.toString().length == 1)
	  					mes = "0"+mes;
	  				var ano = data.getFullYear();  
	  				return ano+"-"+mes+"-"+dia;
	  			}

	  			function getPercelasArray(){
	  				parcelas     = new Array(); 
	  				var contador = 0; 

	  				$('#parcelas_body').find('tr').each(function(){
	  					var entrada,data,destino,documento,numDocumento,palavraChave,custoInt; 

	  					$(this).find('td').each(function(){
	  						var children = $(this).children();  

	  						if(children.is('input.entrada'))
	  							entrada      = children.val(); 
	  						if(children.is('input.data'))
	  							data         = children.val(); 
	  						if(children.is('select.destino'))
	  							destino      = children.val(); 
	  						if(children.is('select.documento'))
	  							documento    = children.val();
	  						if(children.is('input.num_documento'))
	  							numDocumento = children.val();
	  						if(children.is('input.palavra_chave'))
	  							palavraChave = children.val();
	  						if(children.is('input.custo_int'))
	  							custoInt     = children.val();	
	  					}); 

	  					parcelas.push({'entrada' : entrada, 'data' : data, 'destino' : destino, 'documento' : documento, 'num_documento' : numDocumento, 'palavra_chave' : palavraChave, 'custo_int' : custoInt } ); 
	  				});

	  var temp = new Array(); 
	  for( var a = 0 ; a < parcelas.length; a++){
	  	temp.push({name : 'parcela['+a+']', value : JSON.stringify(parcelas[a]) }); 
	  }
	  return temp; 
	}

}); 
	</script>
</body>
<!--footer bagin -->  
<!-- $Include templates/lib/html/footertag.html --> 
<!--footer end--> 
</html>
